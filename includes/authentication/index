<h1 id='authorization-and-authentication'>AUTHORIZATION AND AUTHENTICATION</h1>
<h2 id='sign-in'>Sign in</h2>

<blockquote>
<p>Request</p>
</blockquote>

<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">POST</span> <span class="nn">/v1/auth</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">api.paradise.game</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">58</span>

<span class="p">{</span><span class="w">
    </span><span class="nl">"phone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"01021004364"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"password"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Test@123"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">--location</span> <span class="s1">'https://api.paradise.game/v1/auth'</span> <span class="se">\</span>
<span class="nt">--header</span> <span class="s1">'Content-Type: application/json'</span> <span class="se">\</span>
<span class="nt">--data-raw</span> <span class="s1">'{
    "phone": "01021004364",
    "password": "Test@123"
}'</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">axios</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">axios</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span>
  <span class="na">phone</span><span class="p">:</span> <span class="dl">"</span><span class="s2">01021004364</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">password</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Test@123</span><span class="dl">"</span><span class="p">,</span>
<span class="p">});</span>

<span class="kd">let</span> <span class="nx">config</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">post</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">maxBodyLength</span><span class="p">:</span> <span class="kc">Infinity</span><span class="p">,</span>
  <span class="na">url</span><span class="p">:</span> <span class="dl">"</span><span class="s2">https://api.paradise.game/v1/auth</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">Content-Type</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">application/json</span><span class="dl">"</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="na">data</span><span class="p">:</span> <span class="nx">data</span><span class="p">,</span>
<span class="p">};</span>

<span class="nx">axios</span>
  <span class="p">.</span><span class="nx">request</span><span class="p">(</span><span class="nx">config</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">));</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
  <span class="p">});</span>
</code></pre></div>

<blockquote>
<p>Response</p>
</blockquote>

<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"account"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"balance"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"accessToken"</span><span class="p">:</span><span class="w"> </span><span class="s2">"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJlMzRlOGQxMDI4ZWY2N2NjYjM3YmZmMzgxNzBhZDk1MTpmMCIsImlhdCI6MTY4MzE2ODA0MywiZXhwIjoxNjgzMTY5OTAzfQ.0rtBUCNwAhMy5_oqkWlVw5I_k5_uT2zTIr4jm0oeLPQ"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"refreshToken"</span><span class="p">:</span><span class="w"> </span><span class="s2">"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2MmYxMTNjYTRiNTliMDc4NmVmMzhhZWQ0NjhjOGU5MzpmNGM3YjZkZGJiN2FkZCIsImlhdCI6MTY4MzE2ODA0MywiZXhwIjoxNjgzMTY5OTAzfQ.n_DGj7snsxQVGD6P9aIFJmRvhuIrjjNudZPWa11-MBU"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>

<p>로그인은 국가 전화번호를 포함한 전화번호와 비밀번호를 통해 진행됩니다.</p>

<p>로그인 성공 시 응답(Response)으로 계정 정보와 인증 토큰을 반환합니다. 계정(Account)은 GNI 소유량을 포함한 정보를 가지고 있습니다.</p>

<h3 id='http-request'>HTTP Request</h3>

<p><code>POST /v1/auth</code></p>

<h3 id='scopes'>Scopes</h3>

<ul>
<li>No permission required</li>
</ul>

<h3 id='response-code'>Response Code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>OK</td>
</tr>
</tbody></table>

<h3 id='response-data'>Response Data</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>account</td>
<td><code>object</code></td>
<td>계정 정보</td>
</tr>
<tr>
<td>account.balance</td>
<td><code>string</code></td>
<td>GNI 소유량</td>
</tr>
<tr>
<td>accessToken</td>
<td><code>string</code></td>
<td>인증 토큰</td>
</tr>
<tr>
<td>refreshToken</td>
<td><code>string</code></td>
<td>재발급 토큰</td>
</tr>
</tbody></table>

<h3 id='access-token'>Access Token</h3>

<p>API 요청의 대부분은 인증 토큰(access_token)을 요구합니다.</p>

<p><code>Authorization: bearer {access_token}</code></p>

<aside class="notice">
응답 JSON 데이터의 <code>accessToken</code>으로 변경하세요.
</aside>

<h3 id='refresh-token'>Refresh Token</h3>

<p>인증 토큰을 재발급할 때 사용됩니다. 인증 토큰의 유효시간은 보안상 이유로 매우 짧기 때문에, 상황에 따라 주기적으로 재발급을 필요로 합니다.</p>

<aside class="success">
accessToken은 31분 동안 유효 합니다. refreshToken은 7일 동안 유효 합니다.
</aside>

<h3 id='error-code'>Error Code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Message</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>401</td>
<td><code>INVALID_CREDENTIALS</code></td>
<td>잘못된 인증정보로 전화번호 또는 비밀번호가 틀림</td>
</tr>
</tbody></table>

<h2 id='refresh-token'>Refresh Token</h2>

<blockquote>
<p>Request</p>
</blockquote>

<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">POST</span> <span class="nn">/v1/auth/refresh</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">api.paradise.game</span>
<span class="na">X-Refresh-Token</span><span class="p">:</span> <span class="s">{refresh_token}</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Bearer {access_token}</span>
</code></pre></div><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">--location</span> <span class="nt">--request</span> POST <span class="s1">'https://api.paradise.game/v1/auth/refresh'</span> <span class="se">\</span>
<span class="nt">--header</span> <span class="s1">'X-Refresh-Token: {refresh_token}'</span> <span class="se">\</span>
<span class="nt">--header</span> <span class="s1">'Authorization: Bearer {access_token}'</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">axios</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">axios</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">config</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">post</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">maxBodyLength</span><span class="p">:</span> <span class="kc">Infinity</span><span class="p">,</span>
  <span class="na">url</span><span class="p">:</span> <span class="dl">"</span><span class="s2">https://api.paradise.game/v1/auth/refresh</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">X-Refresh-Token</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">{refresh_token}</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">Authorization</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Bearer {access_token}</span><span class="dl">"</span><span class="p">,</span>
  <span class="p">},</span>
<span class="p">};</span>

<span class="nx">axios</span>
  <span class="p">.</span><span class="nx">request</span><span class="p">(</span><span class="nx">config</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">));</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
  <span class="p">});</span>
</code></pre></div>

<blockquote>
<p>Response</p>
</blockquote>

<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"accessToken"</span><span class="p">:</span><span class="w"> </span><span class="s2">"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJlMzRlOGQxMDI4ZWY2N2NjYjM3YmZmMzgxNzBhZDk1MTpmMCIsImlhdCI6MTY4MzE2ODA0MywiZXhwIjoxNjgzMTY5OTAzfQ.0rtBUCNwAhMy5_oqkWlVw5I_k5_uT2zTIr4jm0oeLPQ"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>

<p>인증 토큰이 만료 될 경우(또는 그 전에) 토큰을 재발급 받아야 됩니다.</p>

<p><code>accessToken</code>은 보안상에 이유로 유효 시간이 짧습니다. 프로그램 명세에 따라 토큰이 만료되기 전 재발급을 통해 유효 시간을 유지하세요.</p>

<h3 id='http-request'>HTTP Request</h3>

<p><code>POST /v1/auth/refresh</code></p>

<h3 id='scopes'>Scopes</h3>

<ul>
<li><code>user:anonymous</code></li>
<li><code>user:verified</code></li>
<li><code>user:account</code></li>
</ul>

<h3 id='request-header'>Request Header</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>X-Refresh-Token</td>
<td>true</td>
<td>재발급 토큰</td>
</tr>
</tbody></table>

<h3 id='response-code'>Response Code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>200</td>
<td>OK</td>
</tr>
</tbody></table>

<h3 id='response-data'>Response Data</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>accessToken</td>
<td><code>string</code></td>
<td>인증 토큰</td>
</tr>
</tbody></table>

<h2 id='send-sms-code'>Send SMS Code</h2>

<blockquote>
<p>Request</p>
</blockquote>

<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">POST</span> <span class="nn">/auth/verification/send</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">api.paradise.game</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Bearer {access_token}</span>
</code></pre></div><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">--location</span> <span class="nt">--request</span> POST <span class="s1">'https://api.paradise.game/v1/auth/verification/send'</span> <span class="se">\</span>
<span class="nt">--header</span> <span class="s1">'Authorization: Bearer {access_token}'</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">axios</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">axios</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">config</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">method</span><span class="p">:</span> <span class="dl">'</span><span class="s1">post</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">maxBodyLength</span><span class="p">:</span> <span class="kc">Infinity</span><span class="p">,</span>
  <span class="na">url</span><span class="p">:</span> <span class="dl">'</span><span class="s1">https://api.paradise.game/v1/auth/verification/send</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">headers</span><span class="p">:</span> <span class="p">{</span> 
    <span class="dl">'</span><span class="s1">Authorization</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Bearer {access_token}</span><span class="dl">'</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="nx">axios</span><span class="p">.</span><span class="nx">request</span><span class="p">(</span><span class="nx">config</span><span class="p">)</span>
<span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">));</span>
<span class="p">})</span>
<span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
<span class="p">});</span>

</code></pre></div>

<p>사용자에게 인증코드를 전송합니다.</p>

<p><code>Twilio API</code>를 이용해 인증코드를 전송합니다. 해당 API에 대한 자세한 내용은 <a href="https://www.twilio.com/docs/sms/send-messages">트윌로 공식 문서</a>를 참고하세요.</p>

<h3 id='http-request'>HTTP Request</h3>

<p><code>POST /verification/send</code></p>

<h3 id='scopes'>SCOPES</h3>

<ul>
<li><code>user:anonymous</code></li>
</ul>

<h3 id='response-code'>Response Code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>204</td>
<td>No Content</td>
</tr>
</tbody></table>

<h3 id='error-code'>Error Code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Message</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>401</td>
<td><code>Unauthorized</code></td>
<td>인증되지 않은 사용자입니다.</td>
</tr>
</tbody></table>

<h2 id='verify-sms-code'>Verify SMS Code</h2>

<blockquote>
<p>Request</p>
</blockquote>

<div class="highlight"><pre class="highlight http tab-http"><code><span class="nf">POST</span> <span class="nn">/auth/verification/sms</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">api.paradise.game</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Bearer {access_token}</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">54</span>

<span class="p">{</span><span class="w">
    </span><span class="nl">"phone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"+821093814181"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"111111"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">--location</span> <span class="s1">'https://api.paradise.game/v1/auth/verification/sms '</span> <span class="se">\</span>
<span class="nt">--header</span> <span class="s1">'Content-Type: application/json'</span> <span class="se">\</span>
<span class="nt">--header</span> <span class="s1">'Authorization: Bearer {access_token}'</span> <span class="se">\</span>
<span class="nt">--data</span> <span class="s1">'{
    "phone": "+821093814181",
    "code": "111111"
}'</span>
</code></pre></div><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">axios</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">axios</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span>
  <span class="dl">"</span><span class="s2">phone</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">+821093814181</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">code</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">111111</span><span class="dl">"</span>
<span class="p">});</span>

<span class="kd">let</span> <span class="nx">config</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">method</span><span class="p">:</span> <span class="dl">'</span><span class="s1">post</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">maxBodyLength</span><span class="p">:</span> <span class="kc">Infinity</span><span class="p">,</span>
  <span class="na">url</span><span class="p">:</span> <span class="dl">'</span><span class="s1">https://api.paradise.game/v1/auth/verification/sms</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">headers</span><span class="p">:</span> <span class="p">{</span> 
    <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span> 
    <span class="dl">'</span><span class="s1">Authorization</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Bearer {access_token}</span><span class="dl">'</span>
  <span class="p">},</span>
  <span class="na">data</span> <span class="p">:</span> <span class="nx">data</span>
<span class="p">};</span>

<span class="nx">axios</span><span class="p">.</span><span class="nx">request</span><span class="p">(</span><span class="nx">config</span><span class="p">)</span>
<span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">));</span>
<span class="p">})</span>
<span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
<span class="p">});</span>

</code></pre></div>

<p>사용자에게서 인증코드를 받아 검증합니다.</p>

<h3 id='http-request'>HTTP Request</h3>

<p><code>POST /verification/sms</code></p>

<h3 id='scopes'>Scopes</h3>

<ul>
<li><code>user:anonymous</code></li>
</ul>

<h3 id='response-code'>Response Code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>204</td>
<td>No Content</td>
</tr>
</tbody></table>

<h3 id='error-code'>Error Code</h3>

<table><thead>
<tr>
<th>Code</th>
<th>Message</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td><code>ALREADY_VERIFIED_PHONE</code></td>
<td>이미 인증된 전화번호</td>
</tr>
<tr>
<td>400</td>
<td><code>INVALID_VERIFICATION_CODE</code></td>
<td>유효하지 않은 인증코드</td>
</tr>
<tr>
<td>401</td>
<td><code>VERIFICATION_CODE_UNAVAILABLE_OR_EXPIRED</code></td>
<td>인증코드가 존재하지 않거나 만료됨</td>
</tr>
</tbody></table>
